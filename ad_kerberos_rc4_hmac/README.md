## AD Kerberos with RC4-HMAC encryption

### Example execution:
```
$ python main.py
[client] Username: user1, password: test1234
[client] Generated NTLM hash for this credentials: 3b1b47e42e0463276e3ded6cef349f93
[client] Full AS_REQ payload:
{'cname': 'user1',
 'sname': ['krbtgt/DC.EXAMPLE.NET'],
 'till': '2021-10-11T00:00:00',
 'timestamp': b'\xb8\xe6"\xb6z\x16{\xd3\xf4S\x03\xbd\xd0G\xf2qv\\^\xa7'
              b'\xfc\xd1Q\x93\xb6\xd0T&',
 'type': 'AS_REQ'}


[kdc] Stored NTLM hash for: user1 is: 3b1b47e42e0463276e3ded6cef349f93
[kdc] Random session key: ['*\x81\x99\x96\x83Á\nJD&\x98÷0\x12#\x1d']
[kdc] Full AS_REP payload:
{'cname': 'user1',
 'encrypted': b"7\x02P\xde\x85\xf0\xa9\xe0h[n\xad\xf1'\xa4\xa7:0=\x9e$\x19\x07p"
              b'6/V{bflHW\xf6\xe1\xb8\x9bw3\x14\x17\xda\xca\x81tc\x83\xad'
              b'Ek\xed\xbe\xc3\x12\xd6\x90\xe34\xdf \xd9Z\x9d\xb9\xd7m\xa0\xc6'
              b'\xae\x96\xc1\x1a\xc3\x88\xa7Q>\r\xcb<\xa4\x95P3\xff\xd3\xf9\x15'
              b'm\x9b3\xac\x08\xc9R\xf34%\xd1\xb1)\x95\x8eX\x1e81\xac'
              b'\\\xc1\xeaY',
 'tgt': b'\xbeP\x99\x10a\xe6\r\x8f\xd5\xc8\x15\xd7\x1d\x13\x88\x06\x14c\xb2\xb7'
        b'rX\x9d\xe1\x13\xa4\xf1pz5\x85\xc0\xf8\xdf\xd9\xf1\xb4\xda\x96\xe7'
        b'\xec\x06\xe7\xccy\x8d\xd79B\x07\x1f\xaa?Ijl_\xf4\xf3+\x1aYo\xa9'
        b'\x83\xca\xa9N\xb4/C\xe7\xf1vr>q\x8a\xd4\x18U\x14\xd5[\r+\x01\x06'
        b'\xe2"l\xbat\xf9[\x0f\xcb\xb4J\xc8\x9b\xb4\x0e\xf5\x96\xb9\x0bi'
        b'\xf8;\x9bxMkYU\xf8\x8c\x1fB\x94\x93\xeb\xd1\x87H\\2\xc9\x162\x9c'
        b'\xf8\xc8\t\x08J\x86\xf8\xa4\x7f\xcf\xe1V\x9f(:e',
 'type': 'AS_REP'}


[client] NTLM hash for cname = user1 is: 3b1b47e42e0463276e3ded6cef349f93
[client] Full TGS_REQ payload:
{'encrypted': b't\x8d\xba5\xb7\t\xae\x08\xa2\\\t8\xfd\x0c\x08$\x10:3!/b\xb2\x08'
              b'\xec\x98\xb3\xf0(\xf2\xa0X\xc94"\xa7\x05\x81D_3\xcf6\xa4'
              b'\xeb\xe0\x1bk\xc3*\xa1cx\x7fA\xe1\xb7T\xc9\xa2\x97\x0eh\xec'
              b'\xf3\xce\xd4',
 'sname': ['http/EXAMPLE.NET'],
 'tgt': b'\xbeP\x99\x10a\xe6\r\x8f\xd5\xc8\x15\xd7\x1d\x13\x88\x06\x14c\xb2\xb7'
        b'rX\x9d\xe1\x13\xa4\xf1pz5\x85\xc0\xf8\xdf\xd9\xf1\xb4\xda\x96\xe7'
        b'\xec\x06\xe7\xccy\x8d\xd79B\x07\x1f\xaa?Ijl_\xf4\xf3+\x1aYo\xa9'
        b'\x83\xca\xa9N\xb4/C\xe7\xf1vr>q\x8a\xd4\x18U\x14\xd5[\r+\x01\x06'
        b'\xe2"l\xbat\xf9[\x0f\xcb\xb4J\xc8\x9b\xb4\x0e\xf5\x96\xb9\x0bi'
        b'\xf8;\x9bxMkYU\xf8\x8c\x1fB\x94\x93\xeb\xd1\x87H\\2\xc9\x162\x9c'
        b'\xf8\xc8\t\x08J\x86\xf8\xa4\x7f\xcf\xe1V\x9f(:e',
 'type': 'TGS_REQ'}


[kdc] Received TGT key is: ['*\x81\x99\x96\x83Á\nJD&\x98÷0\x12#\x1d']
[kdc] Random service session key: ['\x9euÂ\x96t\x9fG\x0c;Ïã\x80¶\x1aL\x02']
[kdc] Full TGS_REP payload:
{'cname': 'user1',
 'encrypted': b'\xd0\x02\x18\xdfpWBF\x06U\xb3\xbb\xd7\tNz_q.\x13I\xf7\x88\xef'
              b'\xcf<\x99\xe8\x8d\x85F\xb4\xc9\xed[z\xc2u\xfa\x9b\x9bV\xe3 '
              b'Lv[\x02\xcf\xd1\x9dl\x98vS\xa8v#\xcbs\x1b\x04\xf0\xcb\xfb\x96S1'
              b'8r8\xe8\xd1\xe3\xb7\xd7\x97K\xa9_\xcetA\xff\xbf\xc7\xcf,'
              b'\xa1\x96_z\xf5\xbfC\xc3\x199\xfbo\x94\x1c\xb2\xca'
              b'\x16\xd6\x9f\x11\x88\x95\x8aV\x81\x16\xaaA\x01',
 'tgs': b'3\xf847\xcc\x1d\xa6\xbe\r\x84/c\x85\x02|y\xb4\xc0\x0e\xd2\xb8bo:'
        b'b\xf8\xc2\x8ce\xf3S\x89\x93\xee\xf1\xfd\x98?\x11\x86\xce\x85\xf3\xc7'
        b'\x87k\xc9\x88`\x1c\xfc+\x12g\x80\xae\x10K7\xeb\x07\x80_\xce'
        b'}\x10\x1a\xfc\x1d\xb5\x16f\x86\xad\xb4\x05\xfc\xfd\xbf\xd5'
        b'\xed\x05\xcb\xd0\xee\x12\xbfH\xeb\x82\xa8Y\x97\xc3\x80\x86'
        b"7\x87\x14\x04\x1b*\xd4p\xf9\xe48\x84x)\x85\xca\xd1W\xb7\xfa!\xad'\x00"
        b'\xc1\xad\xc1\x13\xeb\x07\x02\xcf\xc5\xb4\x19\x85\xa9)X',
 'type': 'TGS_REP'}


[client] Full AP_REQ payload:
{'encrypted': b'\xafv\n\x85,\xb2\xb4\x0c\xce\xd7\x04\xa1\xe1\x7f8\xe2\xb8\xfe/p'
              b'\x1e$W\xb2N!0\x1f\xef\x84\xe4\xbb\xf0Z.0\xde\x83\x1cU'
              b'S\x85\xf6\x02\x89\x9fFf\x95\xe5ty\xe1IB\x08\x12L\x13]\xd0 \nj'
              b'u\x9aT',
 'tgs': b'3\xf847\xcc\x1d\xa6\xbe\r\x84/c\x85\x02|y\xb4\xc0\x0e\xd2\xb8bo:'
        b'b\xf8\xc2\x8ce\xf3S\x89\x93\xee\xf1\xfd\x98?\x11\x86\xce\x85\xf3\xc7'
        b'\x87k\xc9\x88`\x1c\xfc+\x12g\x80\xae\x10K7\xeb\x07\x80_\xce'
        b'}\x10\x1a\xfc\x1d\xb5\x16f\x86\xad\xb4\x05\xfc\xfd\xbf\xd5'
        b'\xed\x05\xcb\xd0\xee\x12\xbfH\xeb\x82\xa8Y\x97\xc3\x80\x86'
        b"7\x87\x14\x04\x1b*\xd4p\xf9\xe48\x84x)\x85\xca\xd1W\xb7\xfa!\xad'\x00"
        b'\xc1\xad\xc1\x13\xeb\x07\x02\xcf\xc5\xb4\x19\x85\xa9)X',
 'type': 'AP_REQ'}


[service] Decrypted TGS:
{'cname': 'user1',
 'endtime': '',
 'key': '\x9euÂ\x96t\x9fG\x0c;Ïã\x80¶\x1aL\x02'}
```